package com.hoioy.diamond.sys.api;import com.hoioy.diamond.common.annotation.BaseJoinId;import com.hoioy.diamond.common.api.BaseJoinController;import com.hoioy.diamond.common.dto.ResultDTO;import com.hoioy.diamond.sys.dto.RoleDTO;import com.hoioy.diamond.sys.dto.RoleUserJoinDTO;import com.hoioy.diamond.sys.dto.UserInfoDTO;import com.hoioy.diamond.sys.service.IRoleService;import com.hoioy.diamond.sys.service.IRoleUserService;import com.hoioy.diamond.sys.service.IUserInfoService;import io.swagger.annotations.Api;import io.swagger.annotations.ApiOperation;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.*;import java.util.Arrays;import java.util.List;@RestController@Api(tags = {"08.用户与角色关联操作接口"})@RequestMapping("/sys/role-user")public class RoleUserController extends BaseJoinController<IRoleUserService, RoleUserJoinDTO> {    @Autowired    private IRoleService iRoleService;    @Autowired    private IUserInfoService iUserInfoService;    @ApiOperation(value = "根据用户Id查询用户所有角色")    @GetMapping(value = "/findRolesByUserId")    public ResultDTO<List<RoleDTO>> findRolesByUserId(String userId) {        List<String> roleIds = iBaseService.findRoleIdsByUserIds(Arrays.asList(userId));        List<RoleDTO> roleDTOS = iRoleService.findByIds(roleIds);        return new ResultDTO(roleDTOS);    }    //TODO zhaozhao 角色下用户量过大，建议使用用户与角色多表关联分页查询替换此方法    @ApiOperation(value = "根据RoleId查询用户所有用户")    @GetMapping(value = "/findUsersByRoleId")    public ResultDTO<List<UserInfoDTO>> findUsersByRoleId(String roleId) {        List<String> roleIds = iBaseService.findUserIdsByRoleIds(Arrays.asList(roleId));        List<UserInfoDTO> userInfoDTOS = iUserInfoService.findByIds(roleIds);        return new ResultDTO(userInfoDTOS);    }    @ApiOperation(value = "根据用户Id集合查询用户与角色关联关系")    @PostMapping(value = "/findByUserIds")    public ResultDTO<List<RoleUserJoinDTO>> findByUserIds(@RequestBody List<String> userIds) {        List<String> ids = iBaseService.findIdsByJoinIds(userIds, BaseJoinId.Index.second);        List<RoleUserJoinDTO> dtoList = iBaseService.findByIds(ids);        return new ResultDTO(dtoList);    }}