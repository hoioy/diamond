package com.hoioy.diamond.sys.api;import com.hoioy.diamond.common.api.BaseController;import com.hoioy.diamond.common.dto.ResultDTO;import com.hoioy.diamond.sys.dto.FileStorageDTO;import com.hoioy.diamond.sys.service.IFileStorageService;import io.swagger.annotations.Api;import io.swagger.annotations.ApiOperation;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.bind.annotation.RestController;import org.springframework.web.multipart.MultipartFile;import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;import java.io.File;import java.io.IOException;@Api(tags = {"12.文件上传接口"})@RestController@RequestMapping("/file")public class FileStorageController extends BaseController<IFileStorageService, FileStorageDTO> implements WebMvcConfigurer {    private static String secondLevelDirectory = "FileStorageController";    public static String secondLevelImgDirectory = "FileStorageControllerImg";    public static String secondLevelImgUrl = "file/img";    // 支持通过URL访问文件    @Override    public void addResourceHandlers(ResourceHandlerRegistry registry) {        String mImagesPath = iBaseService.getFileStorageRootPath();        registry.addResourceHandler("/"+secondLevelImgUrl + "/**").addResourceLocations("file:" + mImagesPath + secondLevelImgDirectory + File.separator);    }    @PostMapping("/upload")    @ApiOperation(value = "上传文件")    public ResultDTO<String> handleFileUpload(@RequestParam("file") MultipartFile file) throws IOException {        String id = iBaseService.saveFile(file, secondLevelDirectory + File.separator, file.getOriginalFilename()).getId();        return new ResultDTO<String>(id);    }}